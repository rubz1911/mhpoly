<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Knowledge Library — One Page</title>
  <style>
    :root{--pad:16px;--radius:16px;--shadow:0 8px 20px rgba(0,0,0,0.08);--muted:#666;}
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,"Helvetica Neue",Arial;}
    body{margin:0;background:#f7f7fb;color:#222;line-height:1.55;padding:24px;max-width:1000px;margin-inline:auto;}
    header{margin-bottom:20px;}
    h1{margin:0 0 6px 0;font-size:1.6rem;}
    .note{color:var(--muted);font-size:0.95rem;margin-top:4px}
    .doc{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:var(--pad);margin:18px 0;}
    .doc h2{margin:0 0 8px 0;font-size:1.15rem}
    .doc .meta{color:var(--muted);font-size:0.9rem;margin-bottom:8px}
    .doc .content{overflow-wrap:anywhere}
    .doc pre{white-space:pre-wrap;margin:0}
    .error{color:#b00020}
    .hidden{display:none}
    .topbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
    .btn{border:1px solid #ddd;background:#fafafa;border-radius:12px;padding:6px 10px;text-decoration:none;color:#222}
    .btn:hover{background:#f0f0f5}
    a{color:#0b57d0;text-decoration:none}
    a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <strong>Knowledge Library — One Page</strong>
      <span class="note">All documents render below on a single page from the <code>/library/</code> folder.</span>
    </div>
    <div class="note">
      Repo: <code>rubz1911/mhpoly</code> — Pages URL: <code>https://rubz1911.github.io/mhpoly/</code><br/>
      To add/remove documents, edit the <code>FILENAMES</code> list in this page (click the pencil in GitHub).
    </div>
  </header>

  <div id="container"></div>

  <script>
    // ---------- EDIT THIS LIST ----------
    // Put your file names here (inside the /library/ subfolder).
    // Example: ["claims-guide.html", "policy-notes.txt"]
    const FILENAMES = [
      "welcome.txt"
    ];
    // ------------------------------------

    const container = document.getElementById("container");

    if (!FILENAMES.length) {
      const info = document.createElement("div");
      info.className = "doc";
      info.innerHTML = `<h2>Setup</h2>
        <div class="meta">No files configured yet.</div>
        <div class="content">
          <ol>
            <li>Upload your <code>.txt</code> or <code>.html</code> files into the <code>library/</code> folder.</li>
            <li>Edit this page and add each filename to <code>FILENAMES</code> (above).</li>
            <li>Save. Reload this page to see all content inline.</li>
          </ol>
        </div>`;
      container.appendChild(info);
    } else {
      FILENAMES.forEach(loadDoc);
    }

    function pagesBase(){
      // Works for https://rubz1911.github.io/mhpoly/ and custom domains
      return `${location.origin}${location.pathname.replace(/\/index\.html?$/,'')}`;
    }
    function fileUrl(name){
      return `${pagesBase()}/library/${encodeURIComponent(name)}`;
    }

    async function loadDoc(name){
      const wrap = document.createElement("article");
      wrap.className = "doc";
      wrap.innerHTML = `<h2>${escapeHtml(name)}</h2>
                        <div class="meta"><a class="btn" href="${fileUrl(name)}" download>Download</a></div>
                        <div class="content">Loading…</div>`;
      container.appendChild(wrap);
      const contentEl = wrap.querySelector(".content");

      try {
        const res = await fetch(fileUrl(name), {cache:"no-store"});
        if(!res.ok) throw new Error(\`HTTP \${res.status}\`);
        const isHTML = /\.html?$/i.test(name);
        const text = await res.text();
        if (isHTML) {
          contentEl.innerHTML = text;
        } else {
          const pre = document.createElement("pre");
          pre.textContent = text;
          contentEl.replaceChildren(pre);
        }
      } catch (err) {
        contentEl.innerHTML = `<span class="error">Could not load this file. Ensure it exists in /library/ and the name is correct.</span>`;
      }
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }
  </script>
</body>
</html>
